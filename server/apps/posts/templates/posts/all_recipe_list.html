<!DOCTYPE html>
<html lang="ko">
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>장금이 요리백서</title>
        {% load static %}
        <link rel="stylesheet" href="{% static 'css/main.css' %}" />
        <link rel="stylesheet" href="{% static 'css/all_recipe_list.css'%}" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&family=Nanum+Brush+Script&family=Yeon+Sung&display=swap" rel="stylesheet" />
    </head>
    <body>
        {% include 'posts/header.html' %}
        <div>전체 레시피</div>
        <div>정렬bar</div>
        <div>
            <div>
                <div>
                    {% for post in posts %}
                    <article class="backgorundcolor">
                        <div>
                            <div>{{post.title}}</div>
                            {% if post.photo %}
                            <p>
                                <img src="{{ post.photo.url }}" />
                            </p>
                            {% endif %}
                            <div>
                                <div>좋아요 개수</div>
                                <div>{{post.created_at}}</div>
                            </div>
                            <div>
                                {%for ele in post.ingredientList%}
                                <div>{{ele}}</div>
                                {%endfor%}
                            </div>
                        </div>
                    </article>
                    <form action="{% url 'posts:delete' post.pk %}" method="post">
                        {% csrf_token %}
                        <input type="submit" , value="삭제하기" />
                    </form>
                    <form action="{% url 'posts:update' post.pk %}" method="get">
                        {% csrf_token %}
                        <input type="submit" , value="수정하기" />
                    </form>
                    {% endfor %}
                </div>
            </div>
            <div class="ajax 처리라서 오른쪽 정렬하고 css안해도됨">
                <div>레시피 상세보기</div>
                <article class="다른 backgorund color클래스">
                    <div>요리 이름</div>
                    <div>
                        <div>재료</div>
                        <div>재료</div>
                        <div>재료</div>
                    </div>
                    <div>
                        <div>사진 넣기</div>
                        <div>레시피 만드는 방법</div>
                    </div>
                    <div>
                        <div>
                            <div>좋아요 개수</div>
                            <div>수정일</div>
                        </div>
                        <div>
                            <a href="#" class="btn-open" onClick="javascript:popOpen();">댓글</a>
                        </div>

                        {% comment %}
                        <!-- 전체 레이아웃 -->
                        <div id="wrap">
                            <!-- Content -->
                            <section class="content">
                                <div class="container">
                                    <!-- 팝업용 임시 버튼입니다. -->
                                    <div class="btn-box">
                                        <a href="#" class="btn-open" onClick="javascript:popOpen();">
                                            <span>열기</span>
                                        </a>
                                    </div>
                                    <!-- //팝업용 임시 버튼입니다. -->
                                </div>
                            </section>
                            <!-- //Content -->
                        </div>
                        <!-- //전체 레이아웃 -->

                        <!-- modal 영역 -->
                        <div class="modal-bg" onClick="javascript:popClose();"></div>
                        <div class="modal-wrap">
                            modal sample
                            <button class="modal-close" onClick="javascript:popClose();">닫기</button>
                        </div>
                        <!-- //modal 영역 -->
                        {% endcomment %}
                    </div>
                </article>
            </div>
        </div>
        {% comment %}
        <style>
            /*   팝업 임시 버튼 스타일  */
            .btn-box .btn-open {
                display: block;
                width: 200px;
                height: 50px;
                margin: 80px auto 0;
                line-height: 50px;
                background: #333;
                text-align: center;
            }

            .btn-box .btn-open span {
                color: #fff;
            }

            /* 팝업 스타일 */
            .modal-bg {
                display: none;
                width: 100%;
                height: 100%;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.6);
                z-index: 999;
            }
            .modal-wrap {
                display: none;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 300px;
                height: 300px;
                background: #fff;
                z-index: 1000;
            }
        </style>
        <script>
            function popOpen() {
                var modalPop = $(".modal-wrap");
                var modalBg = $(".modal-bg");

                $(modalPop).show();
                $(modalBg).show();
            }

            function popClose() {
                var modalPop = $(".modal-wrap");
                var modalBg = $(".modal-bg");

                $(modalPop).hide();
                $(modalBg).hide();
            }
        </script>
        {% endcomment %}
    </body>
</html>
    requestLike.onreadystatechange = () => {
        if (requestLike.readyState === XMLHttpRequest.DONE) {
        if (requestLike.status < 400) {
            const { like_true, number } = JSON.parse(requestLike.response);
            // const element = document.querySelector(`.like_{{post.id}}`);
            const element = document.querySelector(`.like_dislike`);
            const originHTML = element.innerHTML;
            const like_list = originHTML;
            location.reload();
            if (like_true = true){
                const count = Number(number) - 1;
                element.innerHTML = `좋아요 개수: ${count}`;
            }else{
                const count = Number(number) + 1;
                element.innerHTML = `좋아요 개수: ${count}`;
            }
        }
        }
    };
    
    // 
    // Modal을 가져옵니다.
    const modals = document.querySelector(`.modal_{{post.id}}`);
    // Modal을 띄우는 클래스 이름을 가져옵니다.
    const btns = document.querySelector(`.btn_{{post.id}}`);
    // Modal을 닫는 close 클래스를 가져옵니다.
    const spanes = document.querySelector(`.close_{{post.id}}`);
    
    // Modal을 띄우고 닫는 클릭 이벤트를 정의한 함수
    btns.addEventListener("click", e => {
        modals.style.display = "flex"
    })
    spanes.addEventListener("click", e => {
        modals.style.display = "none"
    })
    modals.addEventListener("click", e => {
        const evTarget = e.target
        if(evTarget.classList.contains("modal_{{post.id}}")) {
            modal.style.display = "none"
        }
    })
    // function Modal(num) {
    // return function() {
    //     // 해당 클래스의 내용을 클릭하면 Modal을 띄웁니다.
    //     btns[num].onclick =  function() {
    //         modals[num].style.display = "block";
    //         console.log(num);
    //     };
    
    //     // <span> 태그(X 버튼)를 클릭하면 Modal이 닫습니다.
    //     spanes[num].onclick = function() {
    //         modals[num].style.display = "none";
    //     };
    // };
    // }
    
    // // 원하는 Modal 수만큼 Modal 함수를 호출해서 funcs 함수에 정의합니다.
    // for(var i = 0; i < btns.length; i++) {
    // funcs[i] = Modal(i);
    // }
    
    // // 원하는 Modal 수만큼 funcs 함수를 호출합니다.
    // for(var j = 0; j < btns.length; j++) {
    // funcs[j]();
    // }
    
    // // Modal 영역 밖을 클릭하면 Modal을 닫습니다.
    // window.onclick = function(event) {
    // if (event.target.className == "modal_{{post.id}}") {
    //     event.target.style.display = "none";
    // }
    // };
</script>
{% endblock content %}
